{
  "data": {
    "trace": {
      "spans": [
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060002",
          "spanId": 0,
          "parentSpanId": -1,
          "refs": [],
          "serviceCode": "ts-cancel-service",
          "serviceInstanceName": "a26c98262e3c4813863a0c477bfb2b9f@172.19.0.66",
          "startTime": 1715857986006,
          "endTime": 1715857986073,
          "endpointName": "GET:/api/v1/cancelservice/cancel/{orderId}/{loginId}",
          "type": "Entry",
          "peer": "",
          "component": "SpringMVC",
          "isError": false,
          "layer": "Http",
          "tags": [
            {
              "key": "url",
              "value": "http://172.19.0.66:18885/api/v1/cancelservice/cancel/e3d0f2df-03c8-409d-b9ac-f77cc6ad098d/4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f"
            },
            {
              "key": "http.method",
              "value": "GET"
            },
            {
              "key": "http.status_code",
              "value": "200"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060002",
          "spanId": 1,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-cancel-service",
          "serviceInstanceName": "a26c98262e3c4813863a0c477bfb2b9f@172.19.0.66",
          "startTime": 1715857986009,
          "endTime": 1715857986041,
          "endpointName": "/api/v1/orderservice/order/e3d0f2df-03c8-409d-b9ac-f77cc6ad098d",
          "type": "Exit",
          "peer": "ts-order-service:80",
          "component": "SpringRestTemplate",
          "isError": false,
          "layer": "Http",
          "tags": [
            {
              "key": "url",
              "value": "http://ts-order-service/api/v1/orderservice/order/e3d0f2df-03c8-409d-b9ac-f77cc6ad098d"
            },
            {
              "key": "http.method",
              "value": "GET"
            },
            {
              "key": "http.status_code",
              "value": "200"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.108.17158579860160018",
          "spanId": 0,
          "parentSpanId": -1,
          "refs": [
            {
              "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
              "parentSegmentId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060002",
              "parentSpanId": 1,
              "type": "CROSS_PROCESS"
            }
          ],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986016,
          "endTime": 1715857986038,
          "endpointName": "GET:/api/v1/orderservice/order/{orderId}",
          "type": "Entry",
          "peer": "",
          "component": "SpringMVC",
          "isError": false,
          "layer": "Http",
          "tags": [
            {
              "key": "url",
              "value": "http://172.19.0.41:12031/api/v1/orderservice/order/e3d0f2df-03c8-409d-b9ac-f77cc6ad098d"
            },
            {
              "key": "http.method",
              "value": "GET"
            },
            {
              "key": "http.status_code",
              "value": "200"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.108.17158579860160018",
          "spanId": 1,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986032,
          "endTime": 1715857986032,
          "endpointName": "HikariCP/Connection/getConnection",
          "type": "Local",
          "peer": "",
          "component": "HikariCP",
          "isError": false,
          "layer": "Unknown",
          "tags": [],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.108.17158579860160018",
          "spanId": 2,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986034,
          "endTime": 1715857986034,
          "endpointName": "Mysql/JDBC/PreparedStatement/executeQuery",
          "type": "Exit",
          "peer": "ts-order-mysql:3306",
          "component": "mysql-connector-java",
          "isError": false,
          "layer": "Database",
          "tags": [
            {
              "key": "db.type",
              "value": "Mysql"
            },
            {
              "key": "db.instance",
              "value": "ts"
            },
            {
              "key": "db.statement",
              "value": "select order0_.id as id1_0_0_, order0_.account_id as account_2_0_0_, order0_.bought_date as bought_d3_0_0_, order0_.coach_number as coach_nu4_0_0_, order0_.contacts_document_number as contacts5_0_0_, order0_.contacts_name as contacts6_0_0_, order0_.document_type as document7_0_0_, order0_.from_station as from_sta8_0_0_, order0_.price as price9_0_0_, order0_.seat_class as seat_cl10_0_0_, order0_.seat_number as seat_nu11_0_0_, order0_.status as status12_0_0_, order0_.to_station as to_stat13_0_0_, order0_.train_number as train_n14_0_0_, order0_.travel_date as travel_15_0_0_, order0_.travel_time as travel_16_0_0_ from orders order0_ where order0_.id=?"
            },
            {
              "key": "db.sql.parameters",
              "value": "[e3d0f2df-03c8-409d-b9ac-f77cc6ad098d]"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.108.17158579860160018",
          "spanId": 3,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986035,
          "endTime": 1715857986035,
          "endpointName": "Mysql/JDBC/Connection/commit",
          "type": "Exit",
          "peer": "ts-order-mysql:3306",
          "component": "mysql-connector-java",
          "isError": false,
          "layer": "Database",
          "tags": [
            {
              "key": "db.type",
              "value": "Mysql"
            },
            {
              "key": "db.instance",
              "value": "ts"
            },
            {
              "key": "db.statement",
              "value": ""
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.108.17158579860160018",
          "spanId": 4,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986037,
          "endTime": 1715857986037,
          "endpointName": "HikariCP/Connection/close",
          "type": "Local",
          "peer": "",
          "component": "HikariCP",
          "isError": false,
          "layer": "Unknown",
          "tags": [],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060002",
          "spanId": 2,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-cancel-service",
          "serviceInstanceName": "a26c98262e3c4813863a0c477bfb2b9f@172.19.0.66",
          "startTime": 1715857986042,
          "endTime": 1715857986058,
          "endpointName": "/api/v1/orderservice/order",
          "type": "Exit",
          "peer": "ts-order-service:80",
          "component": "SpringRestTemplate",
          "isError": false,
          "layer": "Http",
          "tags": [
            {
              "key": "url",
              "value": "http://ts-order-service/api/v1/orderservice/order"
            },
            {
              "key": "http.method",
              "value": "PUT"
            },
            {
              "key": "http.status_code",
              "value": "200"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 0,
          "parentSpanId": -1,
          "refs": [
            {
              "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
              "parentSegmentId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060002",
              "parentSpanId": 2,
              "type": "CROSS_PROCESS"
            }
          ],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986046,
          "endTime": 1715857986055,
          "endpointName": "PUT:/api/v1/orderservice/order",
          "type": "Entry",
          "peer": "",
          "component": "SpringMVC",
          "isError": false,
          "layer": "Http",
          "tags": [
            {
              "key": "url",
              "value": "http://172.19.0.41:12031/api/v1/orderservice/order"
            },
            {
              "key": "http.method",
              "value": "PUT"
            },
            {
              "key": "http.status_code",
              "value": "200"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 1,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986049,
          "endTime": 1715857986049,
          "endpointName": "HikariCP/Connection/getConnection",
          "type": "Local",
          "peer": "",
          "component": "HikariCP",
          "isError": false,
          "layer": "Unknown",
          "tags": [],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 2,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986050,
          "endTime": 1715857986050,
          "endpointName": "Mysql/JDBC/PreparedStatement/executeQuery",
          "type": "Exit",
          "peer": "ts-order-mysql:3306",
          "component": "mysql-connector-java",
          "isError": false,
          "layer": "Database",
          "tags": [
            {
              "key": "db.type",
              "value": "Mysql"
            },
            {
              "key": "db.instance",
              "value": "ts"
            },
            {
              "key": "db.statement",
              "value": "select order0_.id as id1_0_0_, order0_.account_id as account_2_0_0_, order0_.bought_date as bought_d3_0_0_, order0_.coach_number as coach_nu4_0_0_, order0_.contacts_document_number as contacts5_0_0_, order0_.contacts_name as contacts6_0_0_, order0_.document_type as document7_0_0_, order0_.from_station as from_sta8_0_0_, order0_.price as price9_0_0_, order0_.seat_class as seat_cl10_0_0_, order0_.seat_number as seat_nu11_0_0_, order0_.status as status12_0_0_, order0_.to_station as to_stat13_0_0_, order0_.train_number as train_n14_0_0_, order0_.travel_date as travel_15_0_0_, order0_.travel_time as travel_16_0_0_ from orders order0_ where order0_.id=?"
            },
            {
              "key": "db.sql.parameters",
              "value": "[e3d0f2df-03c8-409d-b9ac-f77cc6ad098d]"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 3,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986051,
          "endTime": 1715857986051,
          "endpointName": "Mysql/JDBC/Connection/commit",
          "type": "Exit",
          "peer": "ts-order-mysql:3306",
          "component": "mysql-connector-java",
          "isError": false,
          "layer": "Database",
          "tags": [
            {
              "key": "db.type",
              "value": "Mysql"
            },
            {
              "key": "db.instance",
              "value": "ts"
            },
            {
              "key": "db.statement",
              "value": ""
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 4,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986053,
          "endTime": 1715857986053,
          "endpointName": "Mysql/JDBC/PreparedStatement/executeUpdate",
          "type": "Exit",
          "peer": "ts-order-mysql:3306",
          "component": "mysql-connector-java",
          "isError": false,
          "layer": "Database",
          "tags": [
            {
              "key": "db.type",
              "value": "Mysql"
            },
            {
              "key": "db.instance",
              "value": "ts"
            },
            {
              "key": "db.statement",
              "value": "update orders set account_id=?, bought_date=?, coach_number=?, contacts_document_number=?, contacts_name=?, document_type=?, from_station=?, price=?, seat_class=?, seat_number=?, status=?, to_station=?, train_number=?, travel_date=?, travel_time=? where id=?"
            },
            {
              "key": "db.sql.parameters",
              "value": "[4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f,2024-05-16 19:13:05,5,DocumentNumber_One,Contacts_One,1,shanghai,50.0,2,1652907314,4,suzhou,D1345,2024-05-16,2013-05-04 07:00:00,e3d0f2df-03c8-409d-b9ac-f77cc6ad098d]"
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 5,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986053,
          "endTime": 1715857986053,
          "endpointName": "Mysql/JDBC/Connection/commit",
          "type": "Exit",
          "peer": "ts-order-mysql:3306",
          "component": "mysql-connector-java",
          "isError": false,
          "layer": "Database",
          "tags": [
            {
              "key": "db.type",
              "value": "Mysql"
            },
            {
              "key": "db.instance",
              "value": "ts"
            },
            {
              "key": "db.statement",
              "value": ""
            }
          ],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "065487220540450f88f69b53160dde04.109.17158579860460014",
          "spanId": 6,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-order-service",
          "serviceInstanceName": "d8d1ab13e2014c989c049844a120d6b1@172.19.0.41",
          "startTime": 1715857986054,
          "endTime": 1715857986054,
          "endpointName": "HikariCP/Connection/close",
          "type": "Local",
          "peer": "",
          "component": "HikariCP",
          "isError": false,
          "layer": "Unknown",
          "tags": [],
          "logs": []
        },
        {
          "traceId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060003",
          "segmentId": "81ed218850b744f6acdea7be11b8b741.106.17158579860060002",
          "spanId": 3,
          "parentSpanId": 0,
          "refs": [],
          "serviceCode": "ts-cancel-service",
          "serviceInstanceName": "a26c98262e3c4813863a0c477bfb2b9f@172.19.0.66",
          "startTime": 1715857986059,
          "endTime": 1715857986069,
          "endpointName": "/api/v1/inside_pay_service/inside_payment/drawback/4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f/40.00",
          "type": "Exit",
          "peer": "ts-inside-payment-service:80",
          "component": "SpringRestTemplate",
          "isError": true,
          "layer": "Http",
          "tags": [
            {
              "key": "url",
              "value": "http://ts-inside-payment-service/api/v1/inside_pay_service/inside_payment/drawback/4d2a46c7-71cb-4cf1-b5bb-b68406d9da6f/40.00"
            },
            {
              "key": "http.method",
              "value": "GET"
            }
          ],
          "logs": [
            {
              "time": 1715857986069,
              "data": [
                {
                  "key": "event",
                  "value": "error"
                },
                {
                  "key": "error.kind",
                  "value": "java.lang.IllegalStateException"
                },
                {
                  "key": "message",
                  "value": "No instances available for ts-inside-payment-service"
                },
                {
                  "key": "stack",
                  "value": "java.lang.IllegalStateException: No instances available for ts-inside-payment-service\nat org.springframework.cloud.netflix.ribbon.RibbonLoadBalancerClient.execute(RibbonLoadBalancerClient.java:136)\nat org.springframework.cloud.client.loadbalancer.RetryLoadBalancerInterceptor.lambda$intercept$0(RetryLoadBalancerInterceptor.java:100)\nat org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:287)\nat org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:180)\nat org.springframework.cloud.client.loadbalancer.RetryLoadBalancerInterceptor.intercept(RetryLoadBalancerInterceptor.java:77)\nat org.springframework.http.client.InterceptingClientHttpRequest$InterceptingRequestExecution.execute(InterceptingClientHttpRequest.java:93)\nat org.springframework.boot.actuate.metrics.web.client.MetricsClientHttpRequestInterceptor.intercept(MetricsClientHttpRequestInterceptor.java:86)\nat org.springframework.http.client.InterceptingClientHttpRequest$InterceptingRequestExecution.execute(InterceptingClientHttpRequest.java:93)\nat org.springframework.http.client.InterceptingClientHttpRequest.executeInternal(InterceptingClientHttpRequest.java:77)\nat org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:48)\nat org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:53)\nat org.springframework.web.client.RestTemplate.$sw$original$doExecute$pu71rc0(RestTemplate.java:737)\nat org.springframework.web.client.RestTemplate.$sw$original$doExecute$pu71rc0$accessor$$sw$gm7t4l2(RestTemplate.java)\nat org.springframework.web.client.RestTemplate$$sw$auxiliary$8erghp2.call(Unknown Source)\nat org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstMethodsInter.intercept(InstMethodsInter.java:86)\nat org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java)\nat org.springframework.web.client.RestTemplate.execute(RestTemplate.java:672)\nat org.springframework.web.client.RestTemplate.exchange(RestTemplate.java:581)\nat cancel.service.CancelServiceImpl.drawbackMoney(CancelServiceImpl.java:344)\nat cancel.service.CancelServiceImpl.cancelOrder(CancelServiceImpl.java:70)\nat cancel.controller.CancelController.$sw$original$cancelTicket$l4d28a1(CancelController.java:47)\nat cancel.controller.CancelController.$sw$original$cancelTicket$l4d28a1$accessor$$sw$k3tan01(CancelController.java)\nat cancel.controller.CancelController$$sw$auxiliary$ii9jdn1.call(Unknown Source)\nat org.apache.skywalking.apm.agent.core.plugin.interceptor.enhance.InstMethodsInter.intercept(InstMethodsInter.java:86)\nat cancel.controller.CancelController.cancelTicket(CancelController.java)\nat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\nat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190)\nat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)\nat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105)\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878)\nat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792)\nat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)\nat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040)\nat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943)\nat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)\n"
                }
              ]
            }
          ]
        }
      ]
    }
  }
}